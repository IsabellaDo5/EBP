{% extends "layout.html" %}
{% load static %}
{% block title %}
Editar item
{% endblock %}

{% block content %}
<h3>Editar información</h3>
{% for x in info %}
<form action="/item/{{x.5}}/" method="post" class="row g-3" style="margin-top: 2% !important;"
    enctype="multipart/form-data">
    {% csrf_token %}
    <!--PRIMERA FILA-->

    <div class="row">
        <div class="col-sm">
            <img src="{{ MEDIA_URL }}{{x.8}}" class="thumbnail " alt="" id="icon_original" >
            <button type="button" class="btn btn-danger" style="" id="btn_eliminar_icon" data-bs-toggle="modal" data-bs-target="#exampleModal">Eliminar imagen</button>
            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5" id="exampleModalLabel">Confirmar acción</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            ¿Estás seguro de querer eliminar esta imagen? Esta acción no se puede deshacer. 
                            Haga click en el botón "Eliminar" para confirmar esta acción.
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="button" class="btn btn-primary" onclick="usuario_elimina_imagen(event)" data-bs-dismiss="modal">Eliminar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">

        <!--NOMBRE-->
        <div class="col-sm-4">
            <div class="col-auto">
                <label for="staticEmail2" class="visually-hidden">Nombre</label>
                <input type="text" readonly class="form-control-plaintext" id="staticEmail2" value="Nombre">
            </div>
            <div class="col-auto">
                <label for="inputPassword2" class="visually-hidden"></label>
                <input type="text" name="nombre" class="form-control" id="inputPassword2" maxlength="25" required
                    value="{{x.0}}">
            </div>
        </div>

        <!--Precio-->
        <div class="col-sm-4">
            <div class="col-auto">
                <label for="staticEmail2" class="visually-hidden">Precio</label>
                <input type="text" readonly class="form-control-plaintext" id="staticEmail2" value="Precio">
            </div>
            <div class="col-auto">
                <label for="inputPassword2" class="visually-hidden"></label>
                <input type="number" name="precio" class="form-control" id="inputPassword2" maxlength="25" required
                    value="{{x.1}}">
            </div>
        </div>

        <!--tipoItem-->
        <div class="col-md-4">
            <label for="inputState" class="form-label">Tipo de item:</label>
            <select id="inputState" class="form-select" name="id_tipoItem">
                {% for y in catalogo_tipoItem %}
                {% if x.7 == y.nombre %}
                <option selected value="{{y.nombre}}">{{y.nombre}}</option>
                {%else%}
                <option value="{{y.nombre}}">{{y.nombre}}</option>
                {% endif %}
                {% endfor %}
            </select>
        </div>

        <!--Cantidad-->
        <div class="col-sm-4">
            <div class="col-auto">
                <label for="staticEmail2" class="visually-hidden">Cantidad</label>
                <input type="text" readonly class="form-control-plaintext" id="staticEmail2" value="Cantidad">
            </div>
            <div class="col-auto">
                <label for="inputPassword2" class="visually-hidden"></label>
                <input type="number" name="cantidad" step="0.01" class="form-control" id="inputPassword2" maxlength="25" required value="{{x.2}}">

            </div>
        </div>

        <!--Unidad de medida-->
        <div class="col-md-4">
            <label for="inputState" class="form-label">Unidad de medida:</label>
            <select name="unidad_medida" id="inputState" class="form-select">


                {% for unidad in catalogo_medidas %}


                {% if unidad.0 == x.5 %}
                <option selected value="{{x.5}}">{{ unidad.1 }}</option>
                {%else%}
                <option value="{{ unidad.0 }}">{{ unidad.1 }}</option>

                {% endif %}
                {% endfor %}
            </select>
        </div>
        <!--Añadir una imagen-->
        <div class="col-md-4">

            <label for="imagen" class="form-label">Subir una imagen del producto</label>
            <input type="file" class="form-control" name="icon" id="imagen"
                accept=".png, .jpeg, .jpg, .webp">
            <input type="text" class="invisible" name="cambio_img" value="{{x.5}}" id="id_item">

        </div>


    </div>
    <button type="submit" class="btn btn-secondary">Guardar cambios</button>
</form>
{% endfor %}
{% endblock %}

{% block scripts %}
<script src="{% static 'inventario.js' %}"></script>
<script>
    const url_delete = '{% url "eliminar-imagen" %}';

    document.addEventListener("DOMContentLoaded", (event) => {
        mostrar_imagen();
    });
   
  </script>
{% endblock %}